library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5))
wrap_plots(plots_summary_time, ncol = 2)
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y=hours))
wrap_plots(plots_summary_time, ncol = 2)
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time, ncol = 2)
plots_summary_dist <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "distance", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="km"))
wrap_plots(plots_summary_dist, ncol = 2)
plotting_geom <- function(dat, y_var, color) {
this_type <- unique(dat$activity_type)
ggplot(dat, aes(x = month, y = !!sym(y_var), fill = activity_type)) +
# geom_col(alpha = 0.7) +
facet_grid(year ~ ., scales = "fixed") +
scale_x_continuous(
limits = c(0.4, 12.6),
breaks = 1:12,
expand = expansion(mult = c(0, 0))
) +
scale_y_continuous(limits = c(0,NA), expand = expansion(mult=c(0.05,0.1))) +
scale_fill_manual(values = color) +
labs(
title = this_type,
x = "Month"
# y = "Total time (h)"
) +
theme_layout +
theme(
strip.background = element_rect("grey80"),
legend.position = "none",
panel.grid.major = element_line(color = "grey90")
)
}
plots_summary_dist <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "distance", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="km"))
wrap_plots(plots_summary_dist, ncol = 2)
df_minimal %>%
summarise(moving_time_hr = sum(moving_time_hr), by = c("activity_type", "year", "month"))
df_minimal %>%
group_by(c("activity_type", "year", "month")) %>%
summarise(moving_time_hr = sum(moving_time_hr))
df_minimal %>%
group_by("activity_type", "year", "month") %>%
summarise(moving_time_hr = sum(moving_time_hr))
df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr))
m
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr))
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha = 0.7) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col() + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time, ncol = 2)
plots_summary_dist <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "distance", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="km"))
wrap_plots(plots_summary_dist, ncol = 2)
plotting_geom <- function(dat, y_var, color) {
this_type <- unique(dat$activity_type)
ggplot(dat, aes(x = month, y = !!sym(y_var), fill = activity_type)) +
# geom_col(alpha = 0.7) +
facet_grid(year ~ ., scales = "fixed") +
scale_x_continuous(
limits = c(0.4, 12.6),
breaks = 1:12,
expand = expansion(mult = c(0, 0))
) +
scale_y_continuous(limits = c(0,NA), expand = expansion(mult=c(0.05,0.1))) +
scale_fill_manual(values = color) +
labs(
title = this_type,
x = "Month"
# y = "Total time (h)"
) +
theme_layout +
theme(
strip.background = element_rect("grey80"),
legend.position = "none",
panel.grid.major = element_line(color = "grey90")
)
}
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time, ncol = 2)
plots_summary_dist <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "distance", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="km"))
wrap_plots(plots_summary_dist, ncol = 2)
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
source(here("../../","/Library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R/theme/theme_layout.R"))
df_minimal <- acts_raw %>%
select(c("Activity ID", "Activity Date", "Activity Type", "Elapsed Time...6", "Moving Time", "Distance...7")) %>%
rename(
"Elapsed Time" = "Elapsed Time...6",
"Distance" = "Distance...7"
) %>%
clean_names()
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
source(here("../../","/Library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R/theme/theme_layout.R"))
df_minimal <- acts_raw %>%
select(c("Activity ID", "Activity Date", "Activity Type", "Elapsed Time...6", "Moving Time", "Distance...7")) %>%
rename(
"Elapsed Time" = "Elapsed Time...6",
"Distance" = "Distance...7"
) %>%
clean_names()
source(here("../../", "/library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R,/theme/theme_layout.R"))
source(here("../../", "/library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R/theme/theme_layout.R"))
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
source(here("../../", "/library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R/theme/theme_layout.R"))
df_minimal <- acts_raw %>%
select(c("Activity ID", "Activity Date", "Activity Type", "Elapsed Time...6", "Moving Time", "Distance...7")) %>%
rename(
"Elapsed Time" = "Elapsed Time...6",
"Distance" = "Distance...7"
) %>%
clean_names()
raw_path <- here("data/raw/export_26195219/activities.csv")
acts_raw <- read_csv(raw_path, show_col_types = FALSE)
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
source(here("../../", "/library/CloudStorage/OneDrive-Charité-UniversitätsmedizinBerlin/Data_analysis/R_functions/R/theme/theme_layout.R"))
raw_path <- here("data/raw/export_26195219/activities.csv")
acts_raw <- read_csv(raw_path, show_col_types = FALSE)
# tmp <- names(acts_raw) %>%
#   tibble(name = .) %>%
#   filter(str_detect(name, "Dist"))
#
# acts_raw %>% select(all_of(tmp$name)
df_minimal <- acts_raw %>%
select(c("Activity ID", "Activity Date", "Activity Type", "Elapsed Time...6", "Moving Time", "Distance...7")) %>%
rename(
"Elapsed Time" = "Elapsed Time...6",
"Distance" = "Distance...7"
) %>%
clean_names()
df_minimal <- df_minimal %>%
mutate(
activity_date = mdy_hms(activity_date),
year  = year(activity_date),
month = month(activity_date),
day   = day(activity_date),
elapsed_hms = hms::as_hms(elapsed_time),
moving_time = hms::as_hms(moving_time)
) %>%
group_by(year, month, activity_type) %>%
mutate(moving_time_hr = as.numeric(moving_time) / 3600) %>%
filter(activity_type %in% c("Run", "Ride"))
plotting_geom <- function(dat, y_var, color) {
this_type <- unique(dat$activity_type)
ggplot(dat, aes(x = month, y = !!sym(y_var), fill = activity_type)) +
# geom_col(alpha = 0.7) +
facet_grid(year ~ ., scales = "fixed") +
scale_x_continuous(
limits = c(0.4, 12.6),
breaks = 1:12,
expand = expansion(mult = c(0, 0))
) +
scale_y_continuous(limits = c(0,NA), expand = expansion(mult=c(0.05,0.1))) +
scale_fill_manual(values = color) +
labs(
title = this_type,
x = "Month"
# y = "Total time (h)"
) +
theme_layout +
theme(
strip.background = element_rect("grey80"),
legend.position = "none",
panel.grid.major = element_line(color = "grey90")
)
}
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
df_minimal
# # restore r-environment with loaded pacakges. At project-initialization this has already been done.
# renv::restore()
# ---- Load libraries ----
library(here)
library(tidyverse)      # includes dplyr, ggplot2, readr, etc.
library(ggtext)
library(ggrepel)
library(ggpubr)
library(rstatix)
library(yaml)
library(cowplot)
library(sessioninfo)
library(ggforce)
library(ggridges)
library(ggh4x)
library(legendry)
library(RColorBrewer)
library(svglite)
library(tidyHeatmap)
library(viridis)
library(coin)
library(effectsize)
library(officer)
library(flextable)
library(patchwork)
library(readr)
library(lubridate)
library(hms)
library(janitor)
# set filter preference
library(conflicted)
conflict_prefer("filter", "dplyr")
# ---- renv management ----
# This project already has renv initialized via setup script.
# If you install new packages, run:
#   install.packages("pkgname")
#   renv::snapshot()
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
# plots_summary_time_col <- df_minimal %>%
#   group_by(activity_type, year, month) %>%
#   summarise(moving_time_hr = sum(moving_time_hr)) %>%
#   split(.$activity_type) %>%
#   map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
#
# wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time <- df_minimal %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_jitter(width = 0.2, shape = 21, alpha = 0.5) + labs(y="hours"))
wrap_plots(plots_summary_time, ncol = 2)
df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr))
df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type)
df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr)) %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr) , .group = "drop") %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
wrap_plots(plots_summary_time_col, ncol = 2)
plots_summary_time_col <- df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr) , .group = "drop") %>%
split(.$activity_type) %>%
map(~ plotting_geom(.x, y_var = "moving_time_hr", color = cols) + geom_col(alpha= 0.8) + labs(y="hours"))
plots_summary_time_col
df_minimal %>%
group_by(activity_type, year, month) %>%
summarise(moving_time_hr = sum(moving_time_hr) , .group = "drop") %>%
split(.$activity_type)
